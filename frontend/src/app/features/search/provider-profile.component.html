<div class="profile-container">
  <!-- BotÃ³n de regreso -->
  <div class="back-button">
    <button class="btn-back" (click)="router.navigate(['/'])">
      â† Volver a bÃºsqueda
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Cargando perfil...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="error">
    <h3>âš ï¸ Error</h3>
    <p>{{ error }}</p>
    <button class="btn-primary" (click)="router.navigate(['/'])">Volver a bÃºsqueda</button>
  </div>

  <!-- Perfil del proveedor -->
  <div *ngIf="provider && !loading" class="profile-content">
    
    <!-- Header del perfil -->
    <div class="profile-header">
      <div class="profile-image-section">
        <img [src]="getPhotoUrl()" [alt]="provider.name" class="profile-image"
          onerror="this.src='assets/default-avatar.png'" />
        <span *ngIf="provider.isVerified" class="verified-badge-large">
          âœ“ Verificado
        </span>
      </div>

      <div class="profile-header-info">
        <h1 class="provider-name">{{ provider.name }}</h1>
        
        <!-- Rating -->
        <div class="rating-section">
          <div class="stars-display">
            <span *ngFor="let filled of getStars()" class="star" [class.filled]="filled">â­</span>
            <span class="rating-value">{{ provider.rating.toFixed(1) }}/5</span>
          </div>
          <span class="reviews-count">({{ provider.totalReviews }} reseÃ±a{{ provider.totalReviews !== 1 ? 's' : '' }})</span>
        </div>

        <!-- Experiencia -->
        <div class="experience-badge">
          <span class="icon">ğŸ’¼</span>
          <span>{{ provider.experienceYears }} aÃ±os de experiencia</span>
        </div>

        <!-- Rango de precio -->
        <div class="price-range-badge" [ngClass]="provider.priceRange">
          <span class="icon">ğŸ’°</span>
          <span>{{ getPriceRangeText() }}</span>
        </div>

        <!-- Botones de acciÃ³n principales -->
        <div class="action-buttons">
          <button class="btn btn-whatsapp" (click)="openWhatsApp()">
            <span class="icon">ğŸ’¬</span>
            Contactar por WhatsApp
          </button>
          <button class="btn btn-call" (click)="callProvider()">
            <span class="icon">ğŸ“</span>
            Llamar
          </button>
          <button *ngIf="provider.email" class="btn btn-email" (click)="sendEmail()">
            <span class="icon">âœ‰ï¸</span>
            Email
          </button>
        </div>
      </div>
    </div>

    <!-- InformaciÃ³n detallada -->
    <div class="profile-details">
      
      <!-- DescripciÃ³n -->
      <section class="detail-section" *ngIf="provider.description">
        <h2>ğŸ“ Sobre el servicio</h2>
        <p class="description-text">{{ provider.description }}</p>
      </section>

      <!-- InformaciÃ³n de contacto -->
      <section class="detail-section">
        <h2>ğŸ“ InformaciÃ³n de contacto</h2>
        <div class="contact-info">
          <div class="contact-item" *ngIf="provider.phone">
            <span class="contact-label">TelÃ©fono:</span>
            <a [href]="'tel:' + provider.phone" class="contact-value">{{ provider.phone }}</a>
          </div>
          <div class="contact-item" *ngIf="provider.whatsapp">
            <span class="contact-label">WhatsApp:</span>
            <a [href]="getWhatsAppUrl()" target="_blank" class="contact-value">{{ provider.whatsapp }}</a>
          </div>
          <div class="contact-item" *ngIf="provider.email">
            <span class="contact-label">Email:</span>
            <a [href]="'mailto:' + provider.email" class="contact-value">{{ provider.email }}</a>
          </div>
          <div class="contact-item" *ngIf="provider.address">
            <span class="contact-label">DirecciÃ³n:</span>
            <span class="contact-value">{{ provider.address }}</span>
          </div>
        </div>
      </section>

      <!-- CategorÃ­as de servicio -->
      <section class="detail-section" *ngIf="getCategories().length > 0">
        <h2>ğŸ› ï¸ Servicios ofrecidos</h2>
        <div class="categories-list">
          <span *ngFor="let category of getCategories()" class="category-tag-large">
            {{ category.name }}
          </span>
        </div>
      </section>

      <!-- Ãrea de servicio -->
      <section class="detail-section" *ngIf="provider.serviceArea">
        <h2>ğŸ“ Ãrea de servicio</h2>
        <p class="service-area">{{ provider.serviceArea }}</p>
      </section>

      <!-- Certificaciones -->
      <section class="detail-section" *ngIf="provider.certifications && provider.certifications.length > 0">
        <h2>ğŸ† Certificaciones</h2>
        <ul class="certifications-list">
          <li *ngFor="let cert of provider.certifications">{{ cert }}</li>
        </ul>
      </section>

      <!-- Horario de disponibilidad -->
      <section class="detail-section" *ngIf="hasAvailabilitySchedule()">
        <h2>ğŸ• Disponibilidad</h2>
        <div class="schedule-info">
          <pre>{{ provider!.availabilitySchedule | json }}</pre>
        </div>
      </section>

    </div>
  </div>
</div>

