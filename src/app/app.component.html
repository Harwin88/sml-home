<header class="app-header">
  <div class="header-content">
    <div class="header-top">
      <div class="logo-section">
        <a routerLink="/" aria-label="Ir al inicio">
          <h1 class="logo">{{ title }}</h1>
        </a>
      </div>
      
      <nav class="header-nav">
      <div class="nav-main">
        <!-- Botón Inicio -->
        <button 
          class="nav-button" 
          [class.active]="currentRoute === '/'"
          routerLink="/"
          aria-label="Ir al inicio"
        >
          <mat-icon>home</mat-icon>
          <span class="nav-text">Inicio</span>
        </button>

        <!-- Botón Buscar -->
        <button 
          class="nav-button" 
          [class.active]="currentRoute.startsWith('/search')"
          routerLink="/search"
          aria-label="Buscar proveedores"
        >
          <mat-icon>search</mat-icon>
          <span class="nav-text">Buscar</span>
        </button>

        <!-- Menú de Soporte -->
        <button 
          class="nav-button menu-trigger" 
          [matMenuTriggerFor]="supportMenuDropdown"
          aria-label="Menú de soporte"
        >
          <mat-icon>support_agent</mat-icon>
          <span class="nav-text">Soporte</span>
          <mat-icon class="dropdown-icon">keyboard_arrow_down</mat-icon>
        </button>
        <mat-menu #supportMenuDropdown="matMenu" class="header-menu">
          <button 
            mat-menu-item 
            *ngFor="let item of supportMenu"
            [routerLink]="item.route"
            class="menu-item"
          >
            <mat-icon>{{ item.icon }}</mat-icon>
            <span>{{ item.label }}</span>
          </button>
        </mat-menu>

        <!-- Menú Legal -->
        <button 
          class="nav-button menu-trigger" 
          [matMenuTriggerFor]="legalMenuDropdown"
          aria-label="Menú legal"
        >
          <mat-icon>gavel</mat-icon>
          <span class="nav-text">Legal</span>
          <mat-icon class="dropdown-icon">keyboard_arrow_down</mat-icon>
        </button>
        <mat-menu #legalMenuDropdown="matMenu" class="header-menu">
          <button 
            mat-menu-item 
            *ngFor="let item of legalMenu"
            [routerLink]="item.route"
            class="menu-item"
          >
            <mat-icon>{{ item.icon }}</mat-icon>
            <span>{{ item.label }}</span>
          </button>
        </mat-menu>
      </div>

      <div class="nav-secondary">
        <!-- Botón de Usuario/Login -->
        <button 
          *ngIf="!isAuthenticated"
          class="nav-button secondary" 
          (click)="openAuthModal()" 
          aria-label="Iniciar sesión"
        >
          <mat-icon>account_circle</mat-icon>
          <span class="nav-text">Iniciar Sesión</span>
        </button>
        
        <!-- Menú de Usuario Autenticado -->
        <button 
          *ngIf="isAuthenticated"
          class="nav-button menu-trigger" 
          [matMenuTriggerFor]="userMenuDropdown"
          aria-label="Menú de usuario"
        >
          <mat-icon>account_circle</mat-icon>
          <span class="nav-text">{{ currentUser?.email || 'Mi Cuenta' }}</span>
          <mat-icon class="dropdown-icon">keyboard_arrow_down</mat-icon>
        </button>
        <mat-menu #userMenuDropdown="matMenu" class="header-menu">
          <button 
            mat-menu-item 
            [routerLink]="currentUser?.userType === 'provider' ? '/profile/provider' : '/profile'"
            class="menu-item"
          >
            <mat-icon>person</mat-icon>
            <span>Mi Perfil</span>
          </button>
          <button 
            *ngIf="currentUser?.userType === 'regular'"
            mat-menu-item 
            routerLink="/profile/favorites"
            class="menu-item"
          >
            <mat-icon>favorite</mat-icon>
            <span>Mis Favoritos</span>
          </button>
          <button 
            *ngIf="currentUser?.userType === 'provider'"
            mat-menu-item 
            routerLink="/profile/reservations"
            class="menu-item"
          >
            <mat-icon>calendar_today</mat-icon>
            <span>Mis Reservas</span>
          </button>
          <button 
            mat-menu-item 
            (click)="logout()"
            class="menu-item"
          >
            <mat-icon>logout</mat-icon>
            <span>Cerrar Sesión</span>
          </button>
        </mat-menu>

        <button 
          class="nav-button secondary" 
          (click)="openWorkWithUsModal()" 
          aria-label="Trabaja con nosotros"
        >
          <mat-icon>work</mat-icon>
          <span class="nav-text">Trabaja con nosotros</span>
        </button>
        <button 
          class="nav-button secondary" 
          (click)="openWelcomeModal()" 
          aria-label="Información sobre nosotros"
        >
          <mat-icon>info</mat-icon>
          <span class="nav-text">Sobre nosotros</span>
        </button>
      </div>
    </nav>
    </div>

    <!-- Input de búsqueda - Solo se muestra en /search -->
    <div class="search-section" *ngIf="showSearch">
      <div class="header-search-box">
        <mat-icon class="header-search-icon">search</mat-icon>
        <input 
          type="text" 
          [formControl]="searchControl" 
          placeholder="Buscar proveedores de servicios..." 
          class="header-search-input" 
          aria-label="Buscar proveedores"
        />
      </div>
    </div>
  </div>
</header>

<main class="app-main">
  <router-outlet></router-outlet>
</main>

<!-- Footer Global -->
<app-footer 
  (openWelcome)="openWelcomeModal()" 
  (openWorkWithUs)="openWorkWithUsModal()"
></app-footer>

<!-- Cookie Consent Banner -->
<app-cookie-consent></app-cookie-consent>

<!-- Modal de bienvenida -->
<app-welcome-modal *ngIf="showWelcomeModal" (close)="onCloseWelcomeModal()"></app-welcome-modal>

<!-- Modal Trabaja con nosotros -->
<app-work-with-us-modal *ngIf="showWorkWithUsModal" (close)="onCloseWorkWithUsModal()"></app-work-with-us-modal>

<!-- Modal de Autenticación -->
<app-auth-modal *ngIf="showAuthModal" (close)="onCloseAuthModal()" (success)="onAuthSuccess()"></app-auth-modal>
